/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/@reactflow/minimap@11.7.13/dist/esm/index.mjs
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import e,{memo as t,useRef as o,useEffect as n}from"../../react@18.2.0/_esm.js";import r from"../../classcat@5.0.5/_esm.js";import{shallow as i}from"../../zustand@4.5.2/shallow/_esm.js";import{zoom as a,zoomIdentity as s}from"../../d3-zoom@3.0.0/_esm.js";import{select as d,pointer as l}from"../../d3-selection@3.0.0/_esm.js";import{useStore as m,getNodePositionWithOrigin as c,useStoreApi as h,Panel as p,getBoundsOfRects as u,getNodesBounds as f}from"../core@11.11.3/_esm.js";const g=({id:t,x:o,y:n,width:i,height:a,style:s,color:d,strokeColor:l,strokeWidth:m,className:c,borderRadius:h,shapeRendering:p,onClick:u,selected:f})=>{const{background:g,backgroundColor:k}=s||{},w=d||g||k;return e.createElement("rect",{className:r(["react-flow__minimap-node",{selected:f},c]),x:o,y:n,rx:h,ry:h,width:i,height:a,fill:w,stroke:l,strokeWidth:m,shapeRendering:p,onClick:u?e=>u(e,t):void 0})};g.displayName="MiniMapNode";var k=t(g);const w=e=>e.nodeOrigin,v=e=>e.getNodes().filter((e=>!e.hidden&&e.width&&e.height)),C=e=>e instanceof Function?e:()=>e;var y=t((function({nodeStrokeColor:t="transparent",nodeColor:o="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:a=2,nodeComponent:s=k,onClick:d}){const l=m(v,i),h=m(w),p=C(o),u=C(t),f=C(n),g="undefined"==typeof window||window.chrome?"crispEdges":"geometricPrecision";return e.createElement(e.Fragment,null,l.map((t=>{const{x:o,y:n}=c(t,h).positionAbsolute;return e.createElement(s,{key:t.id,x:o,y:n,width:t.width,height:t.height,style:t.style,selected:t.selected,className:f(t),color:p(t),borderRadius:r,strokeColor:u(t),strokeWidth:a,shapeRendering:g,onClick:d,id:t.id})})))}));const E=e=>{const t=e.getNodes(),o={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:o,boundingRect:t.length>0?u(f(t,e.nodeOrigin),o):o,rfId:e.rfId}};function x({style:t,className:c,nodeStrokeColor:u="transparent",nodeColor:f="#e2e2e2",nodeClassName:g="",nodeBorderRadius:k=5,nodeStrokeWidth:w=2,nodeComponent:v,maskColor:C="rgb(240, 240, 240, 0.6)",maskStrokeColor:x="none",maskStrokeWidth:N=1,position:S="bottom-right",onClick:$,onNodeClick:b,pannable:M=!1,zoomable:R=!1,ariaLabel:_="React Flow mini map",inversePan:z=!1,zoomStep:B=10,offsetScale:W=5}){const I=h(),F=o(null),{boundingRect:O,viewBB:P,rfId:Y}=m(E,i),Z=t?.width??200,A=t?.height??150,L=O.width/Z,T=O.height/A,X=Math.max(L,T),j=X*Z,q=X*A,D=W*X,G=O.x-(j-O.width)/2-D,H=O.y-(q-O.height)/2-D,J=j+2*D,K=q+2*D,Q=`react-flow__minimap-desc-${Y}`,U=o(0);U.current=X,n((()=>{if(F.current){const e=d(F.current),t=e=>{const{transform:t,d3Selection:o,d3Zoom:n}=I.getState();if("wheel"!==e.sourceEvent.type||!o||!n)return;const r=-e.sourceEvent.deltaY*(1===e.sourceEvent.deltaMode?.05:e.sourceEvent.deltaMode?1:.002)*B,i=t[2]*Math.pow(2,r);n.scaleTo(o,i)},o=e=>{const{transform:t,d3Selection:o,d3Zoom:n,translateExtent:r,width:i,height:a}=I.getState();if("mousemove"!==e.sourceEvent.type||!o||!n)return;const d=U.current*Math.max(1,t[2])*(z?-1:1),l={x:t[0]-e.sourceEvent.movementX*d,y:t[1]-e.sourceEvent.movementY*d},m=[[0,0],[i,a]],c=s.translate(l.x,l.y).scale(t[2]),h=n.constrain()(c,m,r);n.transform(o,h)},n=a().on("zoom",M?o:null).on("zoom.wheel",R?t:null);return e.call(n),()=>{e.on("zoom",null)}}}),[M,R,z,B]);const V=$?e=>{const t=l(e);$(e,{x:t[0],y:t[1]})}:void 0,ee=b?(e,t)=>{const o=I.getState().nodeInternals.get(t);b(e,o)}:void 0;return e.createElement(p,{position:S,style:t,className:r(["react-flow__minimap",c]),"data-testid":"rf__minimap"},e.createElement("svg",{width:Z,height:A,viewBox:`${G} ${H} ${J} ${K}`,role:"img","aria-labelledby":Q,ref:F,onClick:V},_&&e.createElement("title",{id:Q},_),e.createElement(y,{onClick:ee,nodeColor:f,nodeStrokeColor:u,nodeBorderRadius:k,nodeClassName:g,nodeStrokeWidth:w,nodeComponent:v}),e.createElement("path",{className:"react-flow__minimap-mask",d:`M${G-D},${H-D}h${J+2*D}v${K+2*D}h${-J-2*D}z\n        M${P.x},${P.y}h${P.width}v${P.height}h${-P.width}z`,fill:C,fillRule:"evenodd",stroke:x,strokeWidth:N,pointerEvents:"none"})))}x.displayName="MiniMap";var N=t(x);export{N as MiniMap};export default null;
